<!DOCTYPE html>
<html class="no-js">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Text-to-Audio Generator</title>
    <meta name="description" content="Upload text and generate audio with custom voices" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
      }

      /* ---------- HEADER NAVIGATION ---------- */
      header {
        background-color: #007bff;
        color: white;
        padding: 1rem 0;
      }
      nav {
        display: flex;
        justify-content: center;
        gap: 2rem;
      }
      nav a {
        color: white;
        text-decoration: none;
        font-size: 1.1rem;
        font-weight: bold;
      }
      nav a:hover {
        text-decoration: underline;
      }

      /* ---------- PAGE CONTENT ---------- */
      .container {
        max-width: 600px;
        background: #fff;
        margin: 2rem auto;
        padding: 2rem;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
        margin-bottom: 1.5rem;
      }
      label {
        display: block;
        margin-top: 1rem;
        font-weight: bold;
      }
      input,
      textarea,
      button {
        width: 100%;
        padding: 0.5rem;
        margin-top: 0.5rem;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 1rem;
      }
      button {
        background-color: #007bff;
        color: white;
        cursor: pointer;
        margin-top: 1rem;
      }
      button:hover {
        background-color: #0056b3;
      }
      audio {
        width: 100%;
        margin-top: 1rem;
      }
      .actor-description {
        margin-top: 0.5rem;
      }

      /* ---------- FILE UPLOAD INFO ---------- */
      .info-section {
        background-color: #e7f3ff;
        border-left: 4px solid #007bff;
        padding: 0.8rem 1rem;
        margin-top: 0.5rem;
        border-radius: 4px;
        font-size: 0.95rem;
        color: #333;
      }
      .info-toggle {
        cursor: pointer;
        color: #007bff;
        font-weight: bold;
        margin-top: 0.5rem;
        display: inline-block;
      }
      .info-content {
        display: none;
        margin-top: 0.5rem;
      }

      footer {
        text-align: center;
        padding: 1rem;
        color: #555;
        font-size: 0.9rem;
      }
    </style>
  </head>

  <body>
    <!-- HEADER NAVIGATION -->
    <header>
      <nav>
        <a href="main.html">Home</a>
        <a href="about.html">About</a>
      </nav>
    </header>

    <div class="container">
      <h1>Text-to-Audio Generator</h1>

      <form id="audioForm">
        <label for="textFile">Upload Text File:</label>
        <input type="file" id="textFile" accept=".txt,.docx" required />

        <!-- File instructions tooltip -->
        <span class="info-toggle" id="toggleInfo">Show file upload instructions ▼</span>
        <div class="info-section info-content" id="fileInfo">
          <ul>
            <li><strong>File types:</strong> Only <code>.txt</code> and <code>.docx</code> are supported.</li>
            <li><strong>Formatting:</strong> Use clear line breaks between paragraphs and dialogue for each character.</li>
            <li><strong>Actor cues:</strong> Label lines or paragraphs with actor names (e.g., <code>Actor 1:</code> or <code>John:</code>).</li>
            <li><strong>Text length:</strong> Keep sections concise for better voice quality.</li>
            <li><strong>Special characters:</strong> Avoid excessive symbols or formatting that may confuse the model.</li>
          </ul>
        </div>

        <label for="numActors">Number of Actors:</label>
        <input type="number" id="numActors" min="1" value="1" />

        <div id="voiceDescriptionsContainer">
          <label>Voice Descriptions:</label>
          <div id="voiceInputs"></div>
        </div>

        <button type="submit">Generate Audio</button>
      </form>

      <div id="output" style="display: none">
        <h2>Generated Audio</h2>
        <audio controls id="audioPlayer"></audio>
      </div>
    </div>

    <footer>
      &copy; 2025 Text-to-Audio App
    </footer>

    <script>
      const form = document.getElementById("audioForm");
      const numActorsInput = document.getElementById("numActors");
      const voiceInputsContainer = document.getElementById("voiceInputs");

      // Generate actor description boxes dynamically
      function updateVoiceInputs() {
        const numActors = parseInt(numActorsInput.value) || 1;
        voiceInputsContainer.innerHTML = "";

        for (let i = 1; i <= numActors; i++) {
          const label = document.createElement("label");
          label.textContent = `Actor ${i} Description:`;

          const input = document.createElement("input");
          input.type = "text";
          input.name = `actor${i}`;
          input.placeholder = `e.g. Actor ${i}: calm female voice`;

          const wrapper = document.createElement("div");
          wrapper.classList.add("actor-description");
          wrapper.appendChild(label);
          wrapper.appendChild(input);

          voiceInputsContainer.appendChild(wrapper);
        }
      }

      // Initialize default
      updateVoiceInputs();
      numActorsInput.addEventListener("change", updateVoiceInputs);

      // Toggle info section
      const toggle = document.getElementById("toggleInfo");
      const info = document.getElementById("fileInfo");

      toggle.addEventListener("click", () => {
        if (info.style.display === "block") {
          info.style.display = "none";
          toggle.textContent = "Show file upload instructions ▼";
        } else {
          info.style.display = "block";
          toggle.textContent = "Hide file upload instructions ▲";
        }
      });

      // Handle form submission
      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const fileInput = document.getElementById("textFile");
        if (!fileInput.files.length) {
          alert("Please upload a text file.");
          return;
        }

        const numActors = parseInt(numActorsInput.value);
        const formData = new FormData();
        formData.append("textFile", fileInput.files[0]);
        formData.append("numActors", numActors);

        // Collect voice descriptions
        const voiceDescriptions = [];
        for (let i = 1; i <= numActors; i++) {
          const desc = form[`actor${i}`].value || "";
          voiceDescriptions.push(desc);
        }
        formData.append("voiceDescriptions", JSON.stringify(voiceDescriptions));

        // Example backend endpoint
        const response = await fetch("/api/generate-audio", {
          method: "POST",
          body: formData,
        });

        if (!response.ok) {
          alert("Error generating audio.");
          return;
        }

        const blob = await response.blob();
        const audioUrl = URL.createObjectURL(blob);

        document.getElementById("output").style.display = "block";
        document.getElementById("audioPlayer").src = audioUrl;
      });
    </script>
  </body>
</html>
